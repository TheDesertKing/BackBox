[{"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 1, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cd %%DBL%%", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 2, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k -i -X GET 'https://%%HOST%%/api/?type=keygen&user=%%USER%%&password=%%PASSWORD%%' > tempkey", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 3, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "sed -n 's/.*<key>\\([^<]*\\)<\\/key>.*/\\1/p' tempkey > key", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 4, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k \"https://%%HOST%%/api/?type=config&action=get&xpath=/config/devices/entry%5B%40name%3D%27localhost.localdomain%27%5D/vsys/entry%5B%40name%3D%27vsys1%27%5D/rulebase/decryption/rules&key=`cat key`\" | tee response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 5, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%RULE_EXISTS%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -c \"//rules/entry[@name='%%DYN_DEC_RULE%%']\" -n response", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 6, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "", "arg1": "%%RULE_EXISTS%%", "condition": "isempty"}], "error_MESSAGE": "Decryption Rule %%DYN_DEC_RULE%% was not found", "command": "echo \"Decryption Rule %%DYN_DEC_RULE%% was not found\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 7, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%SRC_ZONE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//rules/entry[@name='%%DYN_DEC_RULE%%']/from/member\" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 8, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%SRC_IP%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//rules/entry[@name='%%DYN_DEC_RULE%%']/source/member\" -n response", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 9, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "1", "arg2": "any", "arg1": "%%SRC_ZONE%%", "condition": "equal"}, {"operator": "1", "arg2": "any", "arg1": "%%SRC_IP%%", "condition": "equal"}], "error_MESSAGE": "Source Zone and IP are any, should be set specifically", "command": "echo \"Source Zone and IP are any, should be set specifically\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 10, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%DST_ZONE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//rules/entry[@name='%%DYN_DEC_RULE%%']/to/member\" -n response", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 11, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "any", "arg1": "%%DST_ZONE%%", "condition": "equal"}], "error_MESSAGE": "Destination Zone is set to any, should be set specifically to external zone", "command": "echo \"Destination Zone is set to any, should be set specifically to external zone\"", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 12, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "echo -e \"abortion\\nabused-drugs\\nadult\\nalcohol-and-tobacco\\nartificial-intelligence\\nauctions\\nbusiness-and-economy\\ncommand-and-control\\ncomputer-and-internet-info\\ncontent-delivery-networks\\ncopyright-infringement\\ncryptocurrency\\ndating\\ndynamic-dns\\neducational-institutions\\nencrypted-dns\\nentertainment-and-arts\\nextremism\\nfinancial-services\\ngambling\\ngames\\ngovernment\\ngrayware\\nhacking\\nhealth-and-medicine\\nhigh-risk\\nhome-and-garden\\nhunting-and-fishing\\ninsufficient-content\\ninternet-communications-and-telephony\\ninternet-portals\\njob-search\\nlegal\\nlow-risk\\nmalware\\nmedium-risk\\nmilitary\\nmotor-vehicles\\nmusic\\nnewly-registered-domain\\nnews\\nnot-resolved\\nnudity\\nonline-storage-and-backup\\nparked\\npeer-to-peer\\npersonal-sites-and-blogs\\nphilosophy-and-political-advocacy\\nphishing\\nprivate-ip-addresses\\nproxy-avoidance-and-anonymizers\\nquestionable\\nransomware\\nreal-estate\\nreal-time-detection\\nrecreation-and-hobbies\\nreference-and-research\\nreligion\\nscanning-activity\\nsearch-engines\\nsex-education\\nshareware-and-freeware\\nshopping\\nsocial-networking\\nsociety\\nsports\\nstock-advice-and-tools\\nstreaming-media\\nswimsuits-and-intimate-apparel\\ntraining-and-tools\\ntranslation\\ntravel\\nunknown\\nweapons\\nweb-advertisements\\nweb-based-email\\nweb-hosting\" > default_categories", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 13, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "conf_categories", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//rules/entry[@name='%%DYN_DEC_RULE%%']/category/member\" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 14, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%CONF_CATEGORIES%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat conf_categories", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 15, "command_TYPE": "internal", "hide_OUTPUT": false, "description": "", "wait_FOR": "", "save_OUTPUT": "", "output_TYPE": "", "timeout": 0, "sleep": 0, "condition": [{"operator": "2", "arg2": "any", "arg1": "%%CONF_CATEGORIES%%", "condition": "equal"}], "error_MESSAGE": null, "command": "gotoline 20 1", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 16, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "categories_to_test", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "echo \"%%DYN_EXCEPT_CATEGORIES%%\" | tr \",\" \"\\n\"; cat conf_categories", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 17, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "categories_not_set", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "grep -xvFf categories_to_test default_categories", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 18, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%CATEGORIES_NOT_SET%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat categories_not_set", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 19, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "", "arg1": "%%CATEGORIES_NOT_SET%%", "condition": "isnotempty"}], "error_MESSAGE": "URL Categories missing: %%CATEGORIES_NOT_SET%%", "command": "echo \"URL Categories missing: %%CATEGORIES_NOT_SET%%\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 20, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%PROXY_TYPE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -m \"//rules/entry[@name='%%DYN_DEC_RULE%%']/type\" -v \"name(./*)\" -n response", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 21, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "ssl-forward-proxy", "arg1": "%%PROXY_TYPE%%", "condition": "notcontains"}], "error_MESSAGE": "Option Type is set to %%PROXY_TYPE%%, should be SSL Forward Proxy", "command": "echo \"Option Type is set to %%PROXY_TYPE%%, should be SSL Forward Proxy\"", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 22, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cd %%DBL%%; ls | grep -v logs | tee /dev/tty | xargs rm -rf", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "success", "queue": 23, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "ssl-forward-proxy", "arg1": "%%PROXY_TYPE%%", "condition": "contains"}], "error_MESSAGE": "Decryption Rule %%DYN_DEC_RULE%% is properly configured with SSL Forward Proxy Policy", "command": "echo \"Decryption Rule %%DYN_DEC_RULE%% is properly configured with SSL Forward Proxy Policy\"", "session_ID": 0}]