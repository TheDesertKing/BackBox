[{"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 1, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cd %%DBL%%", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 2, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k -i -X GET 'https://%%HOST%%/api/?type=keygen&user=%%USER%%&password=%%PASSWORD%%' > tempkey", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 3, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "sed -n 's/.*<key>\\([^<]*\\)<\\/key>.*/\\1/p' tempkey > key", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 4, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k \"https://%%HOST%%/api/?type=config&action=get&xpath=/config/devices/entry%5B%40name%3D%27localhost.localdomain%27%5D/deviceconfig/system/ssl-tls-service-profile&key=`cat key`\" | tee response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 5, "command_TYPE": "local", "hide_OUTPUT": false, "description": "%%CERT_PROF%%", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%CERT_PROF%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//ssl-tls-service-profile\" -n response", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 6, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "", "arg1": "%%CERT_PROF%%", "condition": "isempty"}], "error_MESSAGE": "No SSL TLS Service Profile is set for browser-based administrator interface", "command": "echo \"No SSL TLS Service Profile is set for browser-based administrator interface\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 7, "command_TYPE": "internal", "hide_OUTPUT": false, "description": "", "wait_FOR": "", "save_OUTPUT": "%%CERT_PROF%%", "output_TYPE": "variable", "timeout": 0, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "url_encode %%CERT_PROF%%", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 8, "command_TYPE": "local", "hide_OUTPUT": false, "description": "profile", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k \"https://%%HOST%%/api/?type=config&action=get&xpath=/config/shared/ssl-tls-service-profile/entry%5B%40name%3D%27%%CERT_PROF%%%27%5D&key=`cat key`\" | tee profile", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 9, "command_TYPE": "local", "hide_OUTPUT": false, "description": "%%CERT_NAME%%", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%CERT_NAME%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//certificate\" -n profile", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 10, "command_TYPE": "internal", "hide_OUTPUT": false, "description": "", "wait_FOR": "", "save_OUTPUT": "%%CERT_NAME%%", "output_TYPE": "variable", "timeout": 0, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "url_encode %%CERT_NAME%%", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 11, "command_TYPE": "local", "hide_OUTPUT": false, "description": "certificate", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k \"https://%%HOST%%/api/?type=config&action=get&xpath=/config/shared/certificate/entry%5B%40name%3D%27%%CERT_NAME%%%27%5D&key=`cat key`\" | tee certificate", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 12, "command_TYPE": "local", "hide_OUTPUT": false, "description": "%%CURRENT_DATE%%", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%DATE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "date +'%Y%m%d'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 13, "command_TYPE": "local", "hide_OUTPUT": false, "description": "%%TO_DATE%%", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%TO_DATE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//not-valid-after\" -n certificate | awk '{print $2 $1 $4}'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 14, "command_TYPE": "local", "hide_OUTPUT": false, "description": "%%FROM_DATE%%", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%FROM_DATE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//not-valid-before\" -n certificate | awk '{print $2 $1 $4}'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 15, "command_TYPE": "local", "hide_OUTPUT": false, "description": "%%FORMATTED_FROM_DATE%%", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%FORMATTED_FROM_DATE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "date +'%Y%m%d' -d \"%%FROM_DATE%%\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 16, "command_TYPE": "local", "hide_OUTPUT": false, "description": "%%FORMATTED_TO_DATE%%", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%FORMATTED_TO_DATE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "date +'%Y%m%d' -d \"%%TO_DATE%%\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 17, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "%%CURRENT_DATE%%", "arg1": "%%FORMATTED_FROM_DATE%%", "condition": "greater"}], "error_MESSAGE": null, "command": "echo \"'From' date is in the future, certificate is not yet valid: %%FORMATTED_FROM_DATE%%\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 18, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "%%CURRENT_DATE%%", "arg1": "%%FORMATTED_TO_DATE%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo \"'To' date is in the past, certificate expired: %%FORMATTED_TO_DATE%%\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 19, "command_TYPE": "local", "hide_OUTPUT": false, "description": "%%ISSUER_NAME%%", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ISSUER_NAME%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//issuer\" -n certificate | awk -F'O[[:space:]]*=[[:space:]]*' '{print $2}' | cut -d',' -f1", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 20, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "1", "arg2": "%%DYN_ISSUER%%", "arg1": "%%ISSUER_NAME%%", "condition": "notcontains"}, {"operator": "1", "arg2": "", "arg1": "%%DYN_ISSUER%%", "condition": "isnotempty"}], "error_MESSAGE": null, "command": "echo \"Issuer name doesn't contain '%%DYN_ISSUER%%', as specified by dynamic field. Issuer name: '%%ISSUER_NAME%%'\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 21, "command_TYPE": "local", "hide_OUTPUT": false, "description": "%%ENCRYPTION_CIPHER%%", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ENCRYPTION_CIPHER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//algorithm\" -n certificate", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 22, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "1", "arg2": "%%DYN_ENCRYPTION%%", "arg1": "%%ENCRYPTION_CIPHER%%", "condition": "notcontains"}, {"operator": "1", "arg2": "", "arg1": "%%DYN_ENCRYPTION%%", "condition": "isnotempty"}], "error_MESSAGE": null, "command": "echo \"Encryption cipher used does not contain '%%DYN_ENCRYPTION%%', as specified by dynamic field. Ecryption cipher used: '%%ENCRYPTION_CIPHER%%'\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 23, "command_TYPE": "local", "hide_OUTPUT": false, "description": "gather the signature's algorithm", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ALGORITHM%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//public-key\" -n certificate |  openssl x509 -text 2>/dev/null | grep \"Signature Algorithm\" | awk 'END {print $NF}'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 24, "command_TYPE": "local", "hide_OUTPUT": false, "description": "algorithm gathered will always be lower case", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%DYN_ALGORITHM%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "", "arg1": "%%DYN_ALGORITHM%%", "condition": "isnotempty"}], "error_MESSAGE": null, "command": "echo '%%DYN_ALGORITHM%%' | tr '[:upper:]' '[:lower:]'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 25, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "1", "arg2": "%%DYN_ALGORITHM%%", "arg1": "%%ALGORITHM%%", "condition": "notcontains"}, {"operator": "1", "arg2": "", "arg1": "%%DYN_ALGORITHM%%", "condition": "isnotempty"}], "error_MESSAGE": null, "command": "echo \"Algorithm used does not contain '%%DYN_ALGORITHM%%', as specified by dynamic field. Algorithm used: '%%ALGORITHM%%'\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 26, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ISSUES%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat issues", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 27, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cd %%DBL%%; ls | grep -v logs | tee /dev/tty | xargs rm -rf", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 28, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "such file", "arg1": "%%ISSUES%%", "condition": "notcontains"}], "error_MESSAGE": "Issues found with the certificate used for browser-based administrator interface:%%ENTER%%%%ISSUES%%", "command": "echo \"Issues found with the certificate used for browser-based administrator interface:\\n%%ISSUES%%\"", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "success", "queue": 29, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "such file", "arg1": "%%ISSUES%%", "condition": "contains"}], "error_MESSAGE": "A valid certificate is set for browser-based administrator interface:%%ENTER%%From date: %%FORMATTED_FROM_DATE%%%%ENTER%%To date:%%FORMATTED_TO_DATE%%%%ENTER%%Issuer organization: %%ISSUER_NAME%%%%ENTER%%Ecryption cipher: %%ENCRYPTION_CIPHER%%%%ENTER%%Algorithm: %%ALGORITHM%%", "command": "echo \"A valid certificate is set for browser-based administrator interface:\\nFrom date: %%FORMATTED_FROM_DATE%%\\nTo date: %%FORMATTED_TO_DATE%%\\nIssuer organization: %%ISSUER_NAME%%\\nEcryption cipher: %%ENCRYPTION_CIPHER%%\\nAlgorithm: %%ALGORITHM%%\"", "session_ID": 0}]