[{"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 1, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cd %%DBL%%", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 2, "command_TYPE": "local", "hide_OUTPUT": false, "description": "request Token", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k -i -X GET 'https://%%HOST%%/api/?type=keygen&user=%%USER%%&password=%%PASSWORD%%' > tempkey", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 3, "command_TYPE": "local", "hide_OUTPUT": false, "description": "Parse Token", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "sed -n 's/.*<key>\\([^<]*\\)<\\/key>.*/\\1/p' tempkey > key", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 4, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k \"https://%%HOST%%/api/?type=op&cmd=<show><config><effective-running><xpath>devices/entry%5B%40name%3D%27localhost.localdomain%27%5D/vsys</xpath></effective-running></config></show>&key=`cat key`\" | tee response", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 5, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k \"https://%%HOST%%/api/?type=op&cmd=<show><config><effective-running><xpath>devices/entry%5B%40name%3D%27localhost.localdomain%27%5D/network/profiles/zone-protection-profile</xpath></effective-running></config></show>&key=`cat key`\" | tee profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 6, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "vsys_list", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//result/vsys/entry/@name\" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 7, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%VSYS_COUNTER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat vsys_list | wc -l", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 8, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%VSYS_NAME%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "head -1 vsys_list; sed -i '1d' vsys_list", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 9, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "vsys_conf", "output_TYPE": "file", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -c \"//result/vsys/entry[@name='%%VSYS_NAME%%']\" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 10, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "zones", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone/entry/@name\" -n vsys_conf", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 11, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%COUNTER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat zones | sed '/^$/d' | wc -l", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 12, "command_TYPE": "internal", "hide_OUTPUT": false, "description": "VSYS has no security zones", "wait_FOR": "", "save_OUTPUT": "", "output_TYPE": "", "timeout": 0, "sleep": 0, "condition": [{"operator": "2", "arg2": "0", "arg1": "%%COUNTER%%", "condition": "equal"}], "error_MESSAGE": null, "command": "gotoline 59 10000", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 13, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ZONE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "head -1 zones; sed -i '1d' zones", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 14, "command_TYPE": "local", "hide_OUTPUT": false, "description": "get zone protection profile of zone", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%PROT_PROFILE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone/entry[@name='%%ZONE%%']/network/zone-protection-profile\" -n vsys_conf", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 15, "command_TYPE": "local", "hide_OUTPUT": false, "description": "if no zone protection profile found issue a warning", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "", "arg1": "%%PROT_PROFILE%%", "condition": "isempty"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - no Zone Protection profile set'", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 16, "command_TYPE": "internal", "hide_OUTPUT": false, "description": "", "wait_FOR": "", "save_OUTPUT": "", "output_TYPE": "", "timeout": 0, "sleep": 0, "condition": [{"operator": "2", "arg2": "", "arg1": "%%PROT_PROFILE%%", "condition": "isempty"}], "error_MESSAGE": null, "command": "gotoline 57 10000", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 17, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%SYN%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/tcp-syn/enable\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 18, "command_TYPE": "local", "hide_OUTPUT": false, "description": "if SYN is not enabled issue a warning", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "yes", "arg1": "%%SYN%%", "condition": "notcontains"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" SYN is not enabled'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 19, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%SYN_ALARM%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/tcp-syn//alarm-rate\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 20, "command_TYPE": "local", "hide_OUTPUT": false, "description": "alarm rate should be 10000 (default) or above", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "10000", "arg1": "%%SYN_ALARM%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" SYN Alarm rate is less then default (10000), should be default or above'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 21, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%SYN_ACTIVATE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/tcp-syn//activate-rate\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 22, "command_TYPE": "local", "hide_OUTPUT": false, "description": "activate rate should be 10000 (default) or above", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "10000", "arg1": "%%SYN_ACTIVATE%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" SYN Activate rate is less then default (10000), should be default or above'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 23, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%SYN_MAXIMAL%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/tcp-syn//maximal-rate\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 24, "command_TYPE": "local", "hide_OUTPUT": false, "description": "maximal rate should be 40000 (default) or above", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "40000", "arg1": "%%SYN_MAXIMAL%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" SYN Maximal rate is less then default (40000), should be default or above'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 25, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%UDP%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/udp/enable\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 26, "command_TYPE": "local", "hide_OUTPUT": false, "description": "if UDP is not enabled issue a warning", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "yes", "arg1": "%%UDP%%", "condition": "notcontains"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" UDP is not enabled'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 27, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%UDP_ALARM%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/udp//alarm-rate\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 28, "command_TYPE": "local", "hide_OUTPUT": false, "description": "alarm rate should be 10000 (default) or above", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "10000", "arg1": "%%UDP_ALARM%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" UDP Alarm rate is less then default (10000), should be default or above'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 29, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%UDP_ACTIVATE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/udp//activate-rate\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 30, "command_TYPE": "local", "hide_OUTPUT": false, "description": "activate rate should be 10000 (default) or above", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "10000", "arg1": "%%UDP_ACTIVATE%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" UDP Activate rate is less then default (10000), should be default or above'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 31, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%UDP_MAXIMAL%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/udp//maximal-rate\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 32, "command_TYPE": "local", "hide_OUTPUT": false, "description": "maximal rate should be 40000 (default) or above", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "40000", "arg1": "%%UDP_MAXIMAL%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" UDP Maximal rate is less then default (40000), should be default or above'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 33, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ICMP%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/icmp/enable\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 34, "command_TYPE": "local", "hide_OUTPUT": false, "description": "if ICMP is not enabled issue a warning", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "yes", "arg1": "%%ICMP%%", "condition": "notcontains"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" ICMP is not enabled'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 35, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ICMP_ALARM%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/icmp//alarm-rate\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 36, "command_TYPE": "local", "hide_OUTPUT": false, "description": "alarm rate should be 10000 (default) or above", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "10000", "arg1": "%%ICMP_ALARM%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" ICMP Alarm rate is less then default (10000), should be default or above'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 37, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ICMP_ACTIVATE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/icmp//activate-rate\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 38, "command_TYPE": "local", "hide_OUTPUT": false, "description": "activate rate should be 10000 (default) or above", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "10000", "arg1": "%%ICMP_ACTIVATE%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" ICMP Activate rate is less then default (10000), should be default or above'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 39, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ICMP_MAXIMAL%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/icmp//maximal-rate\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 40, "command_TYPE": "local", "hide_OUTPUT": false, "description": "maximal rate should be 40000 (default) or above", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "40000", "arg1": "%%ICMP_MAXIMAL%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" ICMP Maximal rate is less then default (40000), should be default or above'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 41, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ICMPV%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/icmpv6/enable\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 42, "command_TYPE": "local", "hide_OUTPUT": false, "description": "if ICMPv6 is not enabled issue a warning", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "yes", "arg1": "%%ICMPV%%", "condition": "notcontains"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" ICMPv6 is not enabled'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 43, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ICMPV6_ALARM%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/icmpv6//alarm-rate\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 44, "command_TYPE": "local", "hide_OUTPUT": false, "description": "alarm rate should be 10000 (default) or above", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "10000", "arg1": "%%ICMPV6_ALARM%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" ICMPv6 Alarm rate is less then default (10000), should be default or above'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 45, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ICMPV6_ACTIVATE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/icmpv6//activate-rate\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 46, "command_TYPE": "local", "hide_OUTPUT": false, "description": "activate rate should be 10000 (default) or above", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "10000", "arg1": "%%ICMPV6_ACTIVATE%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" ICMPv6 Activate rate is less then default (10000), should be default or above'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 47, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ICMPV6_MAXIMAL%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/icmpv6//maximal-rate\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 48, "command_TYPE": "local", "hide_OUTPUT": false, "description": "maximal rate should be 40000 (default) or above", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "40000", "arg1": "%%ICMPV6_MAXIMAL%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" ICMPv6 Maximal rate is less then default (40000), should be default or above'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 49, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%OTHER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/other-ip/enable\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 50, "command_TYPE": "local", "hide_OUTPUT": false, "description": "if OTHER is not enabled issue a warning", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "yes", "arg1": "%%OTHER%%", "condition": "notcontains"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" OTHER is not enabled'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 51, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%OTHER_ALARM%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/other-ip//alarm-rate\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 52, "command_TYPE": "local", "hide_OUTPUT": false, "description": "alarm rate should be 10000 (default) or above", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "10000", "arg1": "%%OTHER_ALARM%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" OTHER Alarm rate is less then default (10000), should be default or above'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 53, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%OTHER_ACTIVATE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/other-ip//activate-rate\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 54, "command_TYPE": "local", "hide_OUTPUT": false, "description": "activate rate should be 10000 (default) or above", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "10000", "arg1": "%%OTHER_ACTIVATE%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" OTHER Activate rate is less then default (10000), should be default or above'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 55, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%OTHER_MAXIMAL%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//zone-protection-profile/entry[@name='%%PROT_PROFILE%%']/flood/other-ip//maximal-rate\" -n profiles_resp", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 56, "command_TYPE": "local", "hide_OUTPUT": false, "description": "maximal rate should be 40000 (default) or above", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "40000", "arg1": "%%OTHER_MAXIMAL%%", "condition": "less"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%: Zone %%ZONE%% - Zone Protection profile \"%%PROT_PROFILE%%\" OTHER Maximal rate is less then default (40000), should be default or above'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 57, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%COUNTER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "echo \"$((%%COUNTER%% - 1))\"", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 58, "command_TYPE": "internal", "hide_OUTPUT": false, "description": "", "wait_FOR": "", "save_OUTPUT": "", "output_TYPE": "", "timeout": 0, "sleep": 0, "condition": [{"operator": "2", "arg2": "0", "arg1": "%%COUNTER%%", "condition": "greater"}], "error_MESSAGE": null, "command": "gotoline 13 10000", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 59, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%VSYS_COUNTER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "echo \"$((%%VSYS_COUNTER%% - 1))\"", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 60, "command_TYPE": "internal", "hide_OUTPUT": false, "description": "", "wait_FOR": "", "save_OUTPUT": "", "output_TYPE": "", "timeout": 0, "sleep": 0, "condition": [{"operator": "2", "arg2": "0", "arg1": "%%VSYS_COUNTER%%", "condition": "greater"}], "error_MESSAGE": null, "command": "gotoline 8 2000", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 61, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ISSUES%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat issues", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 62, "command_TYPE": "local", "hide_OUTPUT": false, "description": "Cleanup", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cd %%DBL%%; ls | grep -v logs | tee /dev/tty | xargs rm -rf", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 63, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "such file", "arg1": "%%ISSUES%%", "condition": "notcontains"}], "error_MESSAGE": "%%ISSUES%%", "command": "echo '%%ISSUES%%'", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "success", "queue": 64, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "such file", "arg1": "%%ISSUES%%", "condition": "contains"}], "error_MESSAGE": "All zones have a Zone Protection profile with tuned Flood Protection settings enabled for all flood types", "command": "echo 'All zones have a Zone Protection profile with tuned Flood Protection settings enabled for all flood types'", "session_ID": 0}]