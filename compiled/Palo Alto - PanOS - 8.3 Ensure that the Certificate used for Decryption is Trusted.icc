[{"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 1, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cd %%DBL%%", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 2, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k -i -X GET 'https://%%HOST%%/api/?type=keygen&user=%%USER%%&password=%%PASSWORD%%' > tempkey", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 3, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "sed -n 's/.*<key>\\([^<]*\\)<\\/key>.*/\\1/p' tempkey > key", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 4, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k \"https://%%HOST%%/api/?type=config&action=get&xpath=/config/shared/certificate&key=`cat key`\" | tee response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 5, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%CERT_EXISTS%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -c \"//entry[@name='%%DYN_CERT_NAME%%']\" -n response", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 6, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "", "arg1": "%%CERT_EXISTS%%", "condition": "isempty"}], "error_MESSAGE": "Certificate %%DYN_CERT_NAME%% not found", "command": "echo \"Certificate %%DYN_CERT_NAME%% not found\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 7, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%IS_CA%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//entry[@name='%%DYN_CERT_NAME%%']/ca\" -n response", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 8, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "yes", "arg1": "%%IS_CA%%", "condition": "notcontains"}], "error_MESSAGE": "Certificate %%DYN_CERT_NAME%% is not Trusted CA", "command": "echo \"Certificate %%DYN_CERT_NAME%% is not Trusted CA\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 9, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%NOT_VALID_BEFORE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//entry[@name='%%DYN_CERT_NAME%%']/not-valid-before\" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 10, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%NOT_VALID_AFTER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//entry[@name='%%DYN_CERT_NAME%%']/not-valid-after\" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 11, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%NOT_VALID_BEFORE%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "echo $(($(date '+%s')-$(date -d \"%%NOT_VALID_BEFORE%%\" '+%s')))", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 12, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "0", "arg1": "%%NOT_VALID_BEFORE%%", "condition": "less"}], "error_MESSAGE": "Certificate %%DYN_CERT_NAME%% is not valid, start date is in the future", "command": "echo \"Certificate %%DYN_CERT_NAME%% is not valid, start date is in the future\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 13, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%NOT_VALID_AFTER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "echo $(($(date -d \"%%NOT_VALID_AFTER%%\" '+%s')-$(date '+%s')))", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 14, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "0", "arg1": "%%NOT_VALID_AFTER%%", "condition": "less"}], "error_MESSAGE": "Certificate %%DYN_CERT_NAME%% is not valid, certificate expired", "command": "echo \"Certificate %%DYN_CERT_NAME%% is not valid, certificate expired\"", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 15, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//entry[@name='%%DYN_CERT_NAME%%']/public-key\" -n response | sed 's/- /-\\n/' | sed 's/ -/\\n-/' | openssl x509 -noout -text | tee cert_info", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 16, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ALGORITHM%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat cert_info | grep \"Signature Algorithm\" | head -1 | awk -F': ' '{print $2}'", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 17, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "1", "arg2": "%%DYN_ALGO%%", "arg1": "%%ALGORITHM%%", "condition": "notcontains"}, {"operator": "1", "arg2": "", "arg1": "%%DYN_ALGO%%", "condition": "isnotempty"}], "error_MESSAGE": "Certificate %%DYN_CERT_NAME%% has algorithm %%ALGORITHM%% set, not %%DYN_ALGO%%, as specified by dynamic field", "command": "echo \"Certificate %%DYN_CERT_NAME%% has algorithm %%ALGORITHM%% set, not %%DYN_ALGO%%, as specified by dynamic field\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 18, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%SUBJECT%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat cert_info | grep \"Subject:\"", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 19, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "1", "arg2": "%%DYN_SUBJECT%%", "arg1": "%%SUBJECT%%", "condition": "notcontains"}, {"operator": "1", "arg2": "", "arg1": "%%DYN_SUBJECT%%", "condition": "isnotempty"}], "error_MESSAGE": "Certificate %%DYN_CERT_NAME%%'s Subject does not contain %%DYN_SUBJECT%%, as specified by dynamic field. Subject: %%SUBJECT%%", "command": "echo \"Certificate %%DYN_CERT_NAME%%'s Subject does not contain %%DYN_SUBJECT%%, as specified by dynamic field. %%SUBJECT%%\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 20, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ISSUER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat cert_info | grep \"Issuer:\"", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 21, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "1", "arg2": "%%DYN_ISSUER%%", "arg1": "%%ISSUER%%", "condition": "notcontains"}, {"operator": "1", "arg2": "", "arg1": "%%DYN_ISSUER%%", "condition": "isnotempty"}], "error_MESSAGE": "Certificate %%DYN_CERT_NAME%%'s Issuer does not contain %%DYN_ISSUER%%, as specified by dynamic field. %%ISSUER%%", "command": "echo \"Certificate %%DYN_CERT_NAME%%'s Issuer does not contain %%DYN_ISSUER%%, as specified by dynamic field. %%ISSUER%%\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 22, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%CA_INFO%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat cert_info | grep \"Issuer:\"", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 23, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "1", "arg2": "%%DYN_CA%%", "arg1": "%%CA_INFO%%", "condition": "notcontains"}, {"operator": "1", "arg2": "", "arg1": "%%DYN_CA%%", "condition": "isnotempty"}], "error_MESSAGE": "Certificate %%DYN_CERT_NAME%%'s CA information does not contain %%DYN_CA%%, as specified by dynamic field. %%CA_INFO%%", "command": "echo \"Certificate %%DYN_CERT_NAME%%'s CA information does not contain %%DYN_CA%%, as specified by dynamic field. %%CA_INFO%%\"", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 24, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k \"https://%%HOST%%/api/?type=config&action=get&xpath=/config/shared/certificate-profile&key=`cat key`\" | tee prof_response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 25, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%PROFILES%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -m \"//certificate-profile/entry[CA/entry[@name='%%DYN_CERT_NAME%%']]\" -v \"@name\" -n prof_response", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 26, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "", "arg1": "%%PROFILES%%", "condition": "isempty"}], "error_MESSAGE": "No Certificate Profiles use certificate %%DYN_CERT_NAME%%", "command": "echo \"No Certificate Profiles use certificate %%DYN_CERT_NAME%%\"", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 27, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "rm -rf key tempkey response cert_info prof_response", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "success", "queue": 28, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "1", "arg2": "0", "arg1": "%%NOT_VALID_AFTER%%", "condition": "greater"}, {"operator": "1", "arg2": "0", "arg1": "%%NOT_VALID_BEFORE%%", "condition": "greater"}], "error_MESSAGE": "CIS 8.2 'SSL Inbound Inspection' is required for all untrusted traffic destined for servers using SSL or TLS is configured : PASS", "command": "echo CIS 8.2 'SSL Inbound Inspection' is required for all untrusted traffic destined for servers using SSL or TLS is configured : PASS", "session_ID": 0}]