[{"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 1, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cd %%DBL%%", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 2, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k -i -X GET 'https://%%HOST%%/api/?type=keygen&user=%%USER%%&password=%%PASSWORD%%' > tempkey", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 3, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "sed -n 's/.*<key>\\([^<]*\\)<\\/key>.*/\\1/p' tempkey > key", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 4, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k \"https://%%HOST%%/api/?type=config&action=get&xpath=/config/shared/log-settings&key=`cat key`\" | tee response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 5, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "v3profiles", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -m \"//snmptrap/entry[.//v3]\" -v \"@name\" -n response | sed '/^$/d'", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 6, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%COUNTER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat v3profiles | sed '/^$/d' | wc -l", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 7, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%SNMPPROF%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "head -1 v3profiles; sed -i '1d' v3profiles", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 8, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%USER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//snmptrap/entry[@name='%%SNMPPROF%%']/version/v3/server/entry/user\" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 9, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%AUTHPWD%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//snmptrap/entry[@name='%%SNMPPROF%%']/version/v3/server/entry/authpwd \" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 10, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%PRIVPWD%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//snmptrap/entry[@name='%%SNMPPROF%%']/version/v3/server/entry/privpwd\" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 11, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%COUNTER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "echo $((%%COUNTER%%-1))", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 12, "command_TYPE": "local", "hide_OUTPUT": false, "description": "If SNMP Profile is valid", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "valid_profiles", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "1", "arg2": "", "arg1": "%%USER%%", "condition": "isnotempty"}, {"operator": "1", "arg2": "", "arg1": "%%AUTHPWD%%", "condition": "isnotempty"}, {"operator": "1", "arg2": "", "arg1": "%%PRIVPWD%%", "condition": "isnotempty"}], "error_MESSAGE": null, "command": "echo \"%%SNMPPROF%%\"", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 13, "command_TYPE": "internal", "hide_OUTPUT": false, "description": "", "wait_FOR": "", "save_OUTPUT": "", "output_TYPE": "", "timeout": 0, "sleep": 0, "condition": [{"operator": "2", "arg2": "0", "arg1": "%%COUNTER%%", "condition": "greater"}], "error_MESSAGE": null, "command": "gotoline 7 100", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 14, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%VALID_PROFILES%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat valid_profiles | sed '/^$/d'", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 15, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "", "arg1": "%%VALID_PROFILES%%", "condition": "isempty"}], "error_MESSAGE": "No SNMP profile found configured as V3 and fields User,Auth Password and Priv Password filled. There should be at least one.", "command": "echo \"No SNMP profile found configured as V3 and fields User,Auth Password and Priv Password filled. There should be at least one.\"", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 16, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%P_COUNTER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat valid_profiles | sed '/^$/d' | wc -l", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 17, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%VALID_SNMPPROF%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "head -1 valid_profiles; sed -i '1d' valid_profiles", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 18, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "system", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -m \"//system/match-list/entry[send-snmptrap/member='%%VALID_SNMPPROF%%' and filter='All Logs']\" -v \"@name\" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 19, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "config", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -m \"//config/match-list/entry[send-snmptrap/member='%%VALID_SNMPPROF%%' and filter='All Logs']\" -v \"@name\" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 20, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "userid", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -m \"//userid/match-list/entry[send-snmptrap/member='%%VALID_SNMPPROF%%' and filter='All Logs']\" -v \"@name\" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 21, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "hip", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -m \"//hipmatch/match-list/entry[send-snmptrap/member='%%VALID_SNMPPROF%%' and filter='All Logs']\" -v \"@name\" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 22, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "iptag", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -m \"//iptag/match-list/entry[send-snmptrap/member='%%VALID_SNMPPROF%%' and filter='All Logs']\" -v \"@name\" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 23, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%P_COUNTER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "echo $((%%P_COUNTER%%-1))", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 24, "command_TYPE": "internal", "hide_OUTPUT": false, "description": "", "wait_FOR": "", "save_OUTPUT": "", "output_TYPE": "", "timeout": 0, "sleep": 0, "condition": [{"operator": "2", "arg2": "0", "arg1": "%%P_COUNTER%%", "condition": "greater"}], "error_MESSAGE": null, "command": "gotoline 17 100", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 25, "command_TYPE": "local", "hide_OUTPUT": false, "description": "Check if empty then write 'System'", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "categoeies_missing_profile", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "if ! grep -q '[^[:space:]]' system; then echo \"System\"; fi", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 26, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "categories_missing_profile", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "if ! grep -q '[^[:space:]]' config; then echo \"Configuration\"; fi", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 27, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "categories_missing_profile", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "if ! grep -q '[^[:space:]]' userid; then echo \"User-ID\"; fi", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 28, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "categories_missing_profile", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "if ! grep -q '[^[:space:]]' hip; then echo \"HIP Match\"; fi", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 29, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "categories_missing_profile", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "if ! grep -q '[^[:space:]]' iptag; then echo \"IP-Tag\"; fi", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 30, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%CATEGORIES_MISSING_PROFILES%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat categories_missing_profile", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 31, "command_TYPE": "local", "hide_OUTPUT": false, "description": "Cleanup", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cd %%DBL%%; ls | grep -v logs | tee /dev/tty | xargs rm -rf", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 32, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "", "arg1": "%%CATEGORIES_MISSING_PROFILES%%", "condition": "isnotempty"}], "error_MESSAGE": "No SNMP v3 Logging Profile entry with 'All Logs' set for sections: %%CATEGORIES_MISSING_PROFILES%%", "command": "echo \"No SNMP v3 Logging Profile entry with 'All Logs' set for sections: %%CATEGORIES_MISSING_PROFILES%%\"", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "success", "queue": 33, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "", "arg1": "%%CATEGORIES_MISSING_PROFILES%%", "condition": "isempty"}], "error_MESSAGE": "SNMP v3 Logging Profile with entry 'All Logs' is set for all sections: System, Configuration, User-ID, HIP Match and IP-TAG", "command": "echo \"SNMP v3 Logging Profile with entry 'All Logs' is set for all sections: System, Configuration, User-ID, HIP Match and IP-TAG\"", "session_ID": 0}]