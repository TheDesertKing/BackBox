[{"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 1, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cd %%DBL%%", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 2, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k -i -X GET 'https://%%HOST%%/api/?type=keygen&user=%%USER%%&password=%%PASSWORD%%' > tempkey", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 3, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "sed -n 's/.*<key>\\([^<]*\\)<\\/key>.*/\\1/p' tempkey > key", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 4, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "curl -k \"https://%%HOST%%/api/?type=op&cmd=<show><config><effective-running><xpath>devices/entry%5B%40name%3D%27localhost.localdomain%27%5D/vsys</xpath></effective-running></config></show>&key=`cat key`\" | tee response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 5, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "vsys_list", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -v \"//result/vsys/entry/@name\" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 6, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%VSYS_COUNTER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat vsys_list | wc -l", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 7, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%VSYS_NAME%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "head -1 vsys_list; sed -i '1d' vsys_list", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 8, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "vsys_conf", "output_TYPE": "file", "timeout": 60, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -c \"//result/vsys/entry[@name='%%VSYS_NAME%%']\" -n response", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 9, "command_TYPE": "local", "hide_OUTPUT": false, "description": "get profile groups WITHOUT vulnerability profile", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "groups_missing_vulnerability", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -m \"//profile-group/entry[not(vulnerability/member)]\" -v \"@name\" -n vsys_conf", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 10, "command_TYPE": "local", "hide_OUTPUT": false, "description": "get policies with profile groups lacking vulnerability profile", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "policies_with_bad_group", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "while read bad_group; do xmlstarlet sel -t -m \"//rulebase/security/rules/entry/profile-setting/group/member\" -i \".='$bad_group'\" -v \"//rulebase/security/rules/entry[profile-setting/group/member='$bad_group']/@name\" -n vsys_conf; done < groups_missing_vulnerability", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 11, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "policies_missing_profile", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "xmlstarlet sel -t -m \"//rulebase/security/rules/entry[not(profile-setting/profiles/vulnerability/member) and not(profile-setting/group/member)]\" -v \"@name\" -n vsys_conf", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 12, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "bad_policies", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat policies_missing_profile policies_with_bad_group", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 13, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%BAD_POLICIES%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat bad_policies", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": true, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 14, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "issues", "output_TYPE": "file", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "such file", "arg1": "%%BAD_POLICIES%%", "condition": "notcontains"}], "error_MESSAGE": null, "command": "echo '%%VSYS_NAME%%:'; cat bad_policies", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 15, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%VSYS_COUNTER%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "echo \"$((%%VSYS_COUNTER%% - 1))\"", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 16, "command_TYPE": "internal", "hide_OUTPUT": false, "description": "", "wait_FOR": "", "save_OUTPUT": "", "output_TYPE": "", "timeout": 0, "sleep": 0, "condition": [{"operator": "2", "arg2": "0", "arg1": "%%VSYS_COUNTER%%", "condition": "greater"}], "error_MESSAGE": null, "command": "gotoline 7 2000", "session_ID": 0}, {"saveFlag": true, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 17, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "%%ISSUES%%", "output_TYPE": "variable", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cat issues", "session_ID": 0}, {"saveFlag": false, "statusFlag": false, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": null, "queue": 18, "command_TYPE": "local", "hide_OUTPUT": false, "description": "Cleanup", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [], "error_MESSAGE": null, "command": "cd %%DBL%%; ls | grep -v logs | tee /dev/tty | xargs rm -rf", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "failure", "queue": 19, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "such file", "arg1": "%%ISSUES%%", "condition": "notcontains"}], "error_MESSAGE": "Found Security policies missing Vulnerability profile%%ENTER%%%%ISSUES%%", "command": "echo -e 'Found Security policies missing Vulnerability profile\\n%%ISSUES%%'", "session_ID": 0}, {"saveFlag": false, "statusFlag": true, "outputAppendToFile": false, "collected": false, "addToFileRepository": false, "saveToFilePermissions": 664, "id": 0, "status": "success", "queue": 20, "command_TYPE": "local", "hide_OUTPUT": false, "description": "", "wait_FOR": "[{\"waitfor\":\"BBP\",\"status\":\"success\",\"message\":\"\"}]", "save_OUTPUT": "", "output_TYPE": "", "timeout": 30, "sleep": 0, "condition": [{"operator": "2", "arg2": "such file", "arg1": "%%ISSUES%%", "condition": "contains"}], "error_MESSAGE": "All security policies accross all VSYS have a Vulnerability Protection profile applied", "command": "echo 'All security policies accross all VSYS have a Vulnerability Protection profile applied'", "session_ID": 0}]